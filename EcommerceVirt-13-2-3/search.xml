<?xml version="1.0" encoding="UTF-8"?>
<con:restMockAction xmlns:con="http://eviware.com/soapui/config" name="search" method="GET" resourcePath="/search" id="392e2d91-2cb9-4afe-836c-d0c983583df1">
  <con:settings>
    <con:setting id="92956b11-db13-4f2a-90f3-f11bc6a1950bfileName">search</con:setting>
    <con:setting id="726d9607-d507-4c87-930f-ed674247a767fileName">search</con:setting>
    <con:setting id="07bbbc5b-b327-4e87-9abc-76b00e0374dffileName">search</con:setting>
    <con:setting id="392e2d91-2cb9-4afe-836c-d0c983583df1fileName">search</con:setting>
  </con:settings>
  <con:defaultResponse>Search Response</con:defaultResponse>
  <con:dispatchStyle>CONDITIONAL_MATCH</con:dispatchStyle>
  <con:dispatchConfig/>
  <con:dispatchPath>import java.net.URLDecoder;
def queryString = mockRequest.getRequest().getQueryString()
if (!queryString) {
    return "Missing required query parameters"
}

String[] fields = queryString.split("&amp;");
String[] kv;

HashMap&lt;String, String> params = new HashMap&lt;String, String>()
for (int i = 0; i &lt; fields.length; ++i){
    kv = fields[i].split("=");
    if (2 == kv.length)
     params.put(kv[0], kv[1]); 
}

def sessionid = params.get("sessionid")

// check
if( !context.hasProperty( sessionid ))
 return "Invalid Session Id Fault"

def searchstring = URLDecoder.decode(params.get("searchstring"), "UTF-8")

if (searchstring == "all") 
 return "WildCard Response"
else if (searchstring == "Item 1") 
 return "Item 1 Response"
else if (searchstring == "Item 2") 
 return "Item 2 Response"
else if (searchstring == "Item 3") 
 return "Item 3 Response"
else if (searchstring == "Item 4") 
 return "Item 3 Response"
else if (searchstring == "Item 5") 
 return "Item 5 Response"
else
return "Unknown Response" 
	


return "Search Response"</con:dispatchPath>
  <con:dispatchXPath/>
  <con:parameterDispatcherRuleContainer/>
  <con:routeScript/>
  <con:requestRouteScript/>
  <con:response name="Search Response" id="f6bc4dff-a63a-4530-b290-4eed655c8d12" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{
  "result": {
    "item": [
      {
        "id": "1",
        "description": "One handy protocol droid.",
        "price": "1"
      },
      {
        "id": "2",
        "description": "Item nr 2",
        "price": "2"
      },
      {
        "id": "3",
        "description": "Item nr 3",
        "price": "3"
      },
      {
        "id": "4",
        "description": "${item4description}",
        "price": "4"
      },
      {
        "id": "5",
        "description": "Item nr 5",
        "price": "5"
      }
    ]
  }
}</con:responseContent>
  </con:response>
  <con:response name="Invalid Session Id Fault" id="672599c9-c795-4116-8fc8-8cfd543fa9b1" httpResponseStatus="200" dataSource="">
    <con:settings/>
    <con:responseContent>{"Failed" : "Invalid Session Id"}</con:responseContent>
  </con:response>
  <con:response name="Item 1 Response" id="6c182ace-7813-45dc-857b-60eaac0d9e23" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{
  "result": {
    "item": {
      "id": "Item 1",
      "description": "One handy protocol droid. This droid is fluent in over six million forms of communication and has a lovely golden color. Built by an enthusiast. Mindwiped only once. Can be carried on your back.",
      "price": "1"
    }
  }
}</con:responseContent>
  </con:response>
  <con:response name="Item 2 Response" id="416fe321-ea1f-4db2-bf8b-49bd34352560" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{
  "result": {
    "item": {
      "id": "Item 2",
      "description": "Box of chocolate with several popular items. Covered in Glucose. Recommended safety distance when eating Spring Surprise, 10 feet.",
      "price": "1.99"
    }
  }
}</con:responseContent>
  </con:response>
  <con:response name="Item 3 Response" id="0a71796a-eda1-4998-a8c6-c8c86af86bf0" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{
  "result": {
    "item": {
      "id": "Item 3",
      "description": "One towel. Massively useful thing. Impress the strags with this amazing cloth!",
      "price": "2.99"
    }
  }
}</con:responseContent>
  </con:response>
  <con:response name="Item 4 Response" id="32edd70c-8e5f-4c72-812f-a24ed5bc30c9" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{
  "result": {
    "item": {
      "id": "Item 4",
      "description": "Ono-Sendai 7. The newest cowboy tech from Hosaka. Break the ICE with this conversation piece.",
      "price": "4.99"
    }
  }
}</con:responseContent>
  </con:response>
  <con:response name="Item 5 Response" id="25799b69-40f1-45f4-8005-a756b98fc843" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{
  "result": {
    "item": {
      "id": "Item 5",
      "description": "Ready! API. All your needs for API readiness",
      "price": "499"
    }
  }
}</con:responseContent>
  </con:response>
  <con:response name="Search Fault Response" id="b0503bf6-2541-4771-a116-1d6deebf1d49" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{"No Result" : "The search returned no items"}</con:responseContent>
  </con:response>
  <con:response name="Unknown Response" id="9aa4bd3d-e43d-40e6-adba-c683a65be22e" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{ "Client" : "Unknown Search String" }</con:responseContent>
  </con:response>
  <con:response name="WildCard Response" id="693c2fe3-b907-42d6-8874-0288073bf513" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{
  "result": {
    "item": [
      {
        "id": "1",
        "description": "One handy protocol droid.",
        "price": "1"
      },
      {
        "id": "2",
        "description": "Item nr 2",
        "price": "2"
      },
      {
        "id": "3",
        "description": "Item nr 3",
        "price": "3"
      },
      {
        "id": "4",
        "description": "${item4description}",
        "price": "4"
      },
      {
        "id": "5",
        "description": "Item nr 5",
        "price": "5"
      }
    ]
  }
}</con:responseContent>
  </con:response>
</con:restMockAction>
