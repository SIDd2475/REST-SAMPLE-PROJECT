<?xml version="1.0" encoding="UTF-8"?>
<con:restMockAction xmlns:con="http://eviware.com/soapui/config" name="login" method="GET" resourcePath="/login" id="cf2a87ca-2de9-4a98-849e-ec06b784cef2">
  <con:settings>
    <con:setting id="82d0d51b-1cc5-4a16-835e-f1da0547efbdfileName">login</con:setting>
    <con:setting id="4077dc9c-a527-48c0-95c5-60e8836de5f7fileName">login</con:setting>
    <con:setting id="9c9c8dde-565f-4639-b480-3e94fb8998c9fileName">login</con:setting>
    <con:setting id="cf2a87ca-2de9-4a98-849e-ec06b784cef2fileName">login</con:setting>
  </con:settings>
  <con:defaultResponse>OK Response</con:defaultResponse>
  <con:dispatchStyle>SCRIPT</con:dispatchStyle>
  <con:dispatchConfig/>
  <con:dispatchPath>def queryString = mockRequest.getRequest().getQueryString()
if (!queryString) {
    return "Missing required query parameters"
}

String[] fields = queryString.split("&amp;");
String[] kv;

HashMap&lt;String, String> params = new HashMap&lt;String, String>()
for (int i = 0; i &lt; fields.length; ++i){
    kv = fields[i].split("=");
    if (2 == kv.length)
     params.put(kv[0], kv[1]); 
}

def username = params.get("username")
def password = params.get("password")
def sum = username + password

// validate
//if( sum.length() > 25 || sum.length() &lt; 10 || !username.startsWith("Login") || !password.endsWith( "123" ))
// return "Invalid Login Fault"

//if( context.hasProperty( sum ))
// return "Already Logged In Fault"

// seems ok
def sessionid = String.valueOf( Math.random() ).substring( 2 )

context.setProperty( sum, sessionid )
context.setProperty( sessionid, sum )

requestContext.sessionid = sessionid
return "Ok Response"</con:dispatchPath>
  <con:dispatchXPath/>
  <con:parameterDispatcherRuleContainer/>
  <con:routeScript/>
  <con:requestRouteScript/>
  <con:response name="OK Response" id="c3894f92-b1bb-4eaa-964c-a4d5c26e31b3" httpResponseStatus="200" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{ "sessionid" : "${sessionid}" }</con:responseContent>
  </con:response>
  <con:response name="Invalid Login Fault" id="5776def1-e6dc-4a54-9162-d0948e19716e" httpResponseStatus="401" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{"Invalid Login" : "The login credentials are invalid&lt;/sam:loginFault" }</con:responseContent>
  </con:response>
  <con:response name="Already Logged In Fault" id="d88e1406-7693-49f1-b9f4-9781d15a0fdc" httpResponseStatus="401" mediaType="application/json" dataSource="">
    <con:settings/>
    <con:responseContent>{ "Already Logged In" : "The specified credentials are already logged in" }</con:responseContent>
  </con:response>
</con:restMockAction>
